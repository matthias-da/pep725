% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/regional_box_ts.R
\name{regional_box_ts}
\alias{regional_box_ts}
\title{Compile Regional Phenology Data and Climate Sensitivity Inputs}
\usage{
regional_box_ts(
  pep = get("pep", envir = parent.frame()),
  giss = get("giss", envir = parent.frame()),
  lon_min = 4.2,
  lon_max = 8.1,
  lat_min = 44.7,
  lat_max = 48.1,
  species_name = "Triticum aestivum",
  functional_group = NULL,
  year_min = 1961,
  pep_for_giss = c("near", "aggregated"),
  phase = 60
)
}
\arguments{
\item{pep}{A data.table containing the full PEP725 dataset, typically loaded at package startup. Must include at least columns: \code{species}, \code{year}, \code{phase_id}, \code{day}, \code{lat}, \code{lon}. Defaults to a global object \code{pep} from the parent environment.}

\item{giss}{A data.table with GISS global temperature anomalies, typically containing columns \code{year}, \code{dT}, and \code{dT_sm}. Defaults to global object \code{giss}.}

\item{lon_min}{Minimum longitude for spatial filtering of PEP data (default is \code{4.2})}

\item{lon_max}{Maximum longitude for spatial filtering of PEP data (default is \code{8.1})}

\item{lat_min}{Minimum latitude for spatial filtering of PEP data (default is \code{44.7})}

\item{lat_max}{Maximum latitude for spatial filtering of PEP data (default is \code{48.1})}

\item{species_name}{Character name of the species to be extracted (default is \code{"Triticum aestivum"})}

\item{year_min}{Minimum year to include in all outputs (default is \code{1961})}

\item{pep_for_giss}{Selects which PEP data subset to use for merging with GISS data. Either \code{"near"} (box-filtered) or \code{"aggregated"} (global).}

\item{phase}{Integer or vector of phase_id(s) to extract (default is \code{60} = Heading). Named phase mappings are applied.}
}
\value{
A named list with the following elements:
\describe{
\item{\code{pep_agg}}{Global (non-spatially filtered) PEP725 time series for the selected phase(s)}
\item{\code{pep_cgi}}{Spatially filtered PEP725 time series based on lat/lon bounding box}
\item{\code{giss}}{Processed GISS global temperature anomaly data from the given year onwards}
\item{\code{pep_giss}}{Merged data frame of PEP phenology (from selected source) and GISS anomalies}
\item{\code{species}}{Character species name used for filtering (echoed)}
}
}
\description{
Extracts and aggregates phenological observations for a selected species and phenological phase from the PEP725 dataset (globally and spatially filtered), and links them with global temperature anomalies (GISS data). This function supports flexible phase selection and comparative regionalâ€“global climate impact studies.
}
\details{
The function aggregates PEP observations by species, year, and phase,
calculates mean day-of-year (DOY), applies spatial filtering if needed,
and attaches GISS climate anomalies. It also maps \code{phase_id}s to
descriptive names and warns if expected phenological phase are missing
in the selected data.

For climate sensitivity analyses, this output is designed to be used in
downstream plotting functions or regression models linking phenology with
global warming trends.
}
\examples{
\dontrun{
# Typical usage for winter wheat heading phase:
out <- regional_box_ts(species_name = "Triticum aestivum", phase = 10)
str(out)

out <- regional_box_ts(functional_group = "Aromatic_or_medicinal_perennials", phase = 60)
str(out)
}

}
\seealso{
\code{\link{pheno_plot}}, \code{\link{pep}}, \code{\link{giss}}
}
\author{
Matthias Templ
}
