% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_phenological_doys.R
\name{get_phenology_doys}
\alias{get_phenology_doys}
\title{Compute CTRL and SCEN Phenology Day-of-Year Values}
\usage{
get_phenology_doys(
  pep,
  phase1,
  phase2,
  genus_name,
  phenology_method = c("robust_shift", "simple_shift", "gdd_cmip6"),
  ctrl_years = 2011:2021,
  scen_years = 2085:2095,
  calib_years = 1991:2020,
  scen_warming = 3,
  shift_per_deg = -4,
  cmip6_tas = NULL,
  gdd_base = 5,
  gdd_threshold1 = 150,
  gdd_threshold2 = 350,
  regions = NULL,
  delta_Tgl = 2.09,
  giss_data = NULL
)
}
\arguments{
\item{pep}{A data frame containing PEP725 phenology data, including columns
\code{country}, \code{day}, \code{year}, \code{phase_id}, and \code{genus}.}

\item{phase1}{Integer. First phenophase (e.g., 65).}

\item{phase2}{Integer. Second phenophase (e.g., 87).}

\item{genus_name}{Character. Genus to filter (e.g., "Malus").}

\item{phenology_method}{Either \code{"simple_shift"} or \code{"gdd_cmip6"}.}

\item{scen_warming}{Numeric. Warming (°C) for simple shift model.}

\item{shift_per_deg}{Numeric. Shift in DOY per °C warming.}

\item{cmip6_tas}{Optional named list with daily temperature time series
(one numeric vector per country) for GDD phenology.}

\item{gdd_base}{Numeric. Base temperature for GDD accumulation.}

\item{gdd_threshold1}{Numeric. GDD threshold for phenophase 1.}

\item{gdd_threshold2}{Numeric. GDD threshold for phenophase 2.}
}
\value{
A data frame containing:
\item{Country}{Country name}
\item{doy_start_ctrl}{Start DOY for CTRL period}
\item{doy_end_ctrl}{End DOY for CTRL period}
\item{doy_start_scen}{Start DOY for SCEN period}
\item{doy_end_scen}{End DOY for SCEN period}

Compute CTRL and SCEN Phenology Day-of-Year Values

This function computes the mean phenological day-of-year (DOY) for two
phenophases (e.g., BBCH 65 and BBCH 87) for each country. The calculation
can use a simple warming‐shift model or a GDD-based model using CMIP6 daily
temperature time series.

A data frame with:
\item{Country}{Country name}
\item{doy_start_ctrl}{Phase1 DOY (CTRL)}
\item{doy_end_ctrl}{Phase2 DOY (CTRL)}
\item{doy_start_scen}{Phase1 DOY (SCEN)}
\item{doy_end_scen}{Phase2 DOY (SCEN)}
}
\description{
This function computes the mean phenological day-of-year (DOY) for two
phenophases (e.g. BBCH 65 and 87) for each country, using either a simple
warming-shift model or a GDD-based model. Output is suitable for use in
both \code{integral_hail()} and \code{plot_hail_overlap()}.
}
\examples{
\dontrun{
pep <- pep_download()
data(giss)

regions <- c("Austria", "Germany-North", "Germany-South", "Switzerland")

# Simple shift method
d1 <- get_phenology_doys(
  pep = pep,
  phase1 = 65,
  phase2 = 87,
  genus_name = "Malus",
  regions = regions,
  phenology_method = 'simple_shift',
)
d1

# robust shift
d2 <- get_phenology_doys(
  pep = pep,
  phase1 = 65,
  phase2 = 87,
  genus_name = "Malus",
  phenology_method = "robust_shift",
  giss_data = giss,
  regions = regions
)
d2
}

}
\author{
Matthias Templ
}
